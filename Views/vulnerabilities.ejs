<%- include('partials/header.ejs') -%>
<%- include('partials/navbar.ejs') -%>

    <div class="container-fluid mt-4">
        <div class="row">
            <div class="col">
                <h2>Vulnerabilities</h2>
            </div>
            <div class="col-offset-1 mx-5">
                <button class="btn btn-dark">Filter</button>
            </div>
        </div>
        <div class="row my-1">
            <div class="col-12">
                <hr class="top-hr">
            </div>
        </div>
    </div>
    <% if (vulnerabilities) { %>
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col"><span class="text-nowrap">Severity</span></th>
                    <th scope="col"><span class="text-nowrap">CVSSv3 Score</span></th>
                    <th scope="col"><span class="text-nowrap">Name</span></th>
                    <th scope="col"><span class="text-nowrap">Family</span></th>
                    <th scope="col"><span class="text-nowrap">Plugin ID</span></th>
                    <th scope="col"><span class="text-nowrap">Count</span></th>
                </tr>
            </thead>
            <tbody>
    <% vulnerabilities.forEach(function(vulnerability) { %>
                <tr>
                    <th scope="row"><span class="text-nowrap"><span class="dot" id="vuln-count-<%=vulnerability.severity %>"></span></span></td>
                    <td><span class="text-nowrap"><%= vulnerability.cvss %></span></td>
                    <td><span class="text-nowrap"><%= vulnerability.name %></span></td>
                    <td><span class="text-nowrap"><%= vulnerability.family %></span></td>
                    <td><span class="text-nowrap"><%= vulnerability.pluginId %></span></td>
                    <td><span class="text-nowrap"><%= vulnerability.count %></span></td>
                </tr>
    <% }); %>
    <% } %>
            </tbody>
        </table>
    </div>
<%- include('partials/footer.ejs') -%>